import h,{useState as r,useRef as s,useEffect as j}from"../web_modules/react.js";import"./ImgViewer.css.proxy.js";import{getValueWithKeyPath as d}from"./utils.js";export function ImgViewer({imgData:e,altasData:k,keyPathInfo:c,selectedAtlasItem:t,onSelect:u}){const b=s(null),[g,l]=r(1);j(()=>{b.current&&(b.current.onload=()=>{b.current?.width&&l(b.current.width/e.width)})},[e]);let i;function m(){i&&(console.log("clear timeout"),clearTimeout(i)),i=setTimeout(()=>{b.current?.width&&(console.log("img.current.width",b.current.width),l(b.current.width/e.width))},500)}j(()=>(window.addEventListener("resize",m),()=>window.removeEventListener("resize",m)));function v(a){const{id:f}=a.currentTarget.dataset;f&&u(f)}let n=[];return k[c.set]&&e.url&&(n=Object.entries(k[c.set]).map(a=>({name:d(a,c.name),x:d(a,c.x)*g,y:d(a,c.y)*g,w:d(a,c.w)*g,h:d(a,c.h)*g})).map(({name:a,x:f,y:o,w:p,h:q})=>{console.log({name:a,x:f,y:o,w:p,h:q});const w={width:p,height:q,left:f,top:o};return h.createElement("div",{className:`img-viewer__item ${a===t?"selected":""}`,style:w,key:a,"data-id":a,onClick:v})})),h.createElement("div",{className:"img-viewer"},h.createElement("img",{src:e.url,ref:b}),n)}
